from google.cloud import bigquery
import os


# Construct a BigQuery client object.
os.environ['GOOGLE_APPLICATION_CREDENTIALS'] = '/Users/prakou/Downloads/translation-llm-86e95fb15e10.json'
client = bigquery.Client()

table_id = "translation-llm.engati_test.test_table"


rows_to_insert = [
    {"request": ["""{
  "contents": [
    {
      "role": "user",
      "parts": [
        {
          "text": "Give asdasdasdasd a recipe for banana bread."
        }
      ]
    }
  ],
  "system_instruction": {
    "parts": [
      {
        "text": "You are a chef."
      }
    ]
  }
}
     """,
     """{
       "contents": [
         {
           "role": "user",
           "parts": [
             {
               "text": "Give me a recipe for Apple pie."
             }
           ]
         }
       ],
       "system_instruction": {
         "parts": [
           {
             "text": "You are a chef."
           }
         ]
       }
     }
          """,
                 """{
                        "contents": [
                          {
                            "role": "user",
                            "parts": [
                              {
                                "text": "Give me a recipe for banoffie pie."
                              }
                            ]
                          }
                        ],
                        "system_instruction": {
                          "parts": [
                            {
                              "text": "You are a chef."
                            }
                          ]
                        }
                      }
                           """,
                 """{
       "contents": [
         {
           "role": "user",
           "parts": [
             {
               "text": "Give me a recipe for Indian curry."
             }
           ]
         }
       ],
       "system_instruction": {
         "parts": [
           {
             "text": "You are a chef."
           }
         ]
       }
     }
          """,
                 """{
       "contents": [
         {
           "role": "user",
           "parts": [
             {
               "text": "Give me a recipe for vegetable Soup."
             }
           ]
         }
       ],
       "system_instruction": {
         "parts": [
           {
             "text": "You are a chef."
           }
         ]
       }
     }
          """,
                 """{
       "contents": [
         {
           "role": "user",
           "parts": [
             {
               "text": "Give me a recipe for Cold Coffee."
             }
           ]
         }
       ],
       "system_instruction": {
         "parts": [
           {
             "text": "You are a chef."
           }
         ]
       }
     }
          """
                 ]
     }
]

errors = client.insert_rows_json(
    table_id, rows_to_insert, row_ids=[None] * len(rows_to_insert)
)
if errors == []:
    print("New rows have been added.")
else:
    print("Encountered errors while inserting rows: {}".format(errors))
